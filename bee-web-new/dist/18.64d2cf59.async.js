(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{UHEq:function(e,t,a){"use strict";var l=a("7rOj"),n=a("SyOF");Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0,a("+L6B");var r=l(a("2/Rp"));a("/zsF");var s=l(a("PArb"));a("5NDa");var d=l(a("5rEg"));a("Pwec");var o=l(a("CtXQ")),c=l(a("m6D0"));a("miYZ");var u=l(a("tsqr")),i=l(a("M6Zy")),f=l(a("iyqV")),m=l(a("utfd")),p=l(a("o7c0")),h=l(a("sMup"));a("y8nQ");var g,E,y,v=l(a("Vl3Y")),b=n(a("COVA")),w=(l(a("cfWd")),a("jBtN")),k=l(a("oEWm")),C=(l(a("xIpT")),l(a("KIHU"))),S=a("MuoO"),N=(w.utils.imgGet,v["default"].Item),B=(g=(0,S.connect)(function(e){var t=e.global;return{global:t}}),(0,k["default"])(E=g((y=function(e){function t(e){var a;return(0,i["default"])(this,t),a=(0,m["default"])(this,(0,p["default"])(t).call(this,e)),a.handleNextKey=function(e){var t=a.state.step;13===e.which&&a.nextStep(t)},a.clickItem=function(e){a.setState({isShow:e})},a.timeOut=function(e){e-=1,a.setState({time:e})},a.getRegistCode=function(){a.props.form.validateFields(["account"],function(e,t){e||(a.settime(),(0,w.request)(w.apis.reset.getValidateCode.api()+"?phone=".concat(t.account),{method:w.apis.reset.getValidateCode.type}).then(function(e){e&&0===e.code?u["default"].success(e.message):e&&u["default"].error(e.message)}))})},a.quit=function(e){var t=a.props.dispatch;t({type:"global/userOut",payload:{sysToken:e},callback:function(e,t,a){}})},a.settime=function(){a.setState({showTime:!0},function(){if(0===T)return a.setState({showTime:!1,getCodeText:"\u91cd\u65b0\u83b7\u53d6"}),T=60,!1;T--,a.setState({time:T}),a.timer=setTimeout(function(){a.settime()},1e3)})},a.nextStep=function(e){var t=a.props.global.user;a.props.form.validateFields(function(l,n){if(!l)if(2===e)(0,w.request)(w.apis.register.registCode.api()+"?".concat(w.utils.queryString(n),"&type=0"),{method:w.apis.register.registCode.type}).then(function(t){t&&(0===t.code?a.setState((0,c["default"])({step:e,phone:n.account},n)):u["default"].error(t.message))});else if(3===e){if(n.password!==n.newPassword)return void u["default"].warning("\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4");(0,w.request)(w.apis.reset.resetPassword.api()+"?password=".concat(n.password,"&phone=").concat(a.state.phone),{method:w.apis.reset.resetPassword.type}).then(function(l){l&&(0===l.code?(a.quit(t.sysToken),a.setState({step:e})):u["default"].warning(l.message))})}})},a.handlePhoneChange=function(e){var t=/^1[3|4|5|6|7|8|9][0-9]{9}$/;t.test(e.target.value)&&a.setState({getCode:!0})},a.turnToLogin=function(){sessionStorage.originPath=location.pathname,C["default"].push("/perLogin")},a.state={isShow:!0,showTime:!1,phoneChange:!1,getCodeText:"\u83b7\u53d6\u9a8c\u8bc1\u7801",time:null,step:1,getCode:!1},a.timer=null,a}return(0,h["default"])(t,e),(0,f["default"])(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleNextKey.bind(this))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.nextStep=null,document.removeEventListener("keydown",this.handleNextKey)}},{key:"render",value:function(){var e=this.state,t=e.step,a=e.showTime,l=e.time,n=(e.getCodeText,e.phoneChange,e.getCode),c=this.props.form.getFieldDecorator,u=o["default"].createFromIconfontCN({scriptUrl:"//at.alicdn.com/t/font_1093886_8rqycotthom.js"});return b["default"].createElement("div",{className:"getBackWrap"},b["default"].createElement("div",{className:"getBackBox"},b["default"].createElement("div",{className:"getBackContent"},b["default"].createElement("h2",null,"\u627e\u56de\u5bc6\u7801"),b["default"].createElement("div",{className:"getBackHead"},b["default"].createElement("dl",null,b["default"].createElement("dt",{style:x}),b["default"].createElement("dd",{style:{color:"rgba(255, 206, 66, 1)"}},"\u9a8c\u8bc1\u8eab\u4efd")),b["default"].createElement("div",{className:"processBar",style:t>1?{background:"rgba(255,206,66,1)"}:{}}),b["default"].createElement("dl",null,b["default"].createElement("dt",{style:t>1?x:{}}),b["default"].createElement("dd",{style:t>1?{color:"rgba(255, 206, 66, 1)"}:{}},"\u91cd\u7f6e\u5bc6\u7801")),b["default"].createElement("div",{className:"processBar",style:t>2?{background:"rgba(255,206,66,1)"}:{}}),b["default"].createElement("dl",null,b["default"].createElement("dt",{style:t>2?x:{}}),b["default"].createElement("dd",{style:t>2?{color:"rgba(255, 206, 66, 1)"}:{}},"\u91cd\u7f6e\u6210\u529f"))),1===t?b["default"].createElement("div",{className:"getBackStepOne"},b["default"].createElement(v["default"],{onSubmit:this.handleSubmit,className:"login-form"},b["default"].createElement(N,{className:"inputBox"},c("account",{rules:[{required:!0,message:"\u624b\u673a\u53f7\u7801\u683c\u5f0f\u4e0d\u6b63\u786e\uff01",pattern:/^1[3|4|5|6|7|8|9][0-9]{9}$/}]})(b["default"].createElement(d["default"],{onChange:this.handlePhoneChange,addonBefore:b["default"].createElement(u,{type:"icon-shouji"}),placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7\u7801"}))),b["default"].createElement(N,{className:"inputBox"},c("code",{rules:[{required:!0,message:"\u8bf7\u586b\u5165\u9a8c\u8bc1\u7801"}]})(b["default"].createElement(d["default"],{placeholder:"\u8bf7\u586b\u5165\u9a8c\u8bc1\u7801",addonBefore:b["default"].createElement(o["default"],{theme:"filled",type:"safety-certificate"}),addonAfter:a?b["default"].createElement("span",{className:"btnClass",style:{color:"rgba(255,255,255,1)",opacity:.5}},b["default"].createElement(s["default"],{type:"vertical"}),l,"s"):b["default"].createElement("span",{className:"btnClass",style:n?{color:"rgba(255,206,66,1)"}:{color:"rgba(255,255,255,1)",opacity:.5},onClick:n?this.getRegistCode:function(){}},b["default"].createElement(s["default"],{type:"vertical"}),"\u83b7\u53d6\u9a8c\u8bc1\u7801")}))),b["default"].createElement(N,{className:"nextStep"},b["default"].createElement(r["default"],{type:"primary",htmlType:"submit",onClick:this.nextStep.bind(this,2)},"\u4e0b\u4e00\u6b65")))):null,2===t?b["default"].createElement("div",{className:"getBackStepTwo"},b["default"].createElement(v["default"],{onSubmit:this.handleSubmit,className:"login-form"},b["default"].createElement(N,{className:"inputBox"},c("password",{rules:[{required:!0,message:"\u8bf7\u586b\u5165\u5bc6\u7801,\u5bc6\u7801\u4e3a\u5b57\u6bcd\u548c\u6570\u5b57\u7684\u7ec4\u5408\u4e14\u4e0d\u5c11\u4e8e8\u4f4d",pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9a-zA-Z]{8,}/}]})(b["default"].createElement(d["default"],{addonBefore:b["default"].createElement(o["default"],{theme:"filled",type:"lock"}),type:"password",placeholder:"8-40\u4f4d\u65b0\u5bc6\u7801\uff0c\u81f3\u5c11\u5305\u542b\u6570\u5b57\u548c\u5b57\u6bcd"}))),b["default"].createElement(N,{className:"inputBox"},c("newPassword",{rules:[{required:!0,message:"\u8bf7\u586b\u5165\u5bc6\u7801,\u5bc6\u7801\u4e3a\u5b57\u6bcd\u548c\u6570\u5b57\u7684\u7ec4\u5408\u4e14\u4e0d\u5c11\u4e8e8\u4f4d",pattern:/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9a-zA-Z]{8,}/}]})(b["default"].createElement(d["default"],{addonBefore:b["default"].createElement(o["default"],{theme:"filled",type:"lock"}),type:"password",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u65b0\u5bc6\u7801"}))),b["default"].createElement(N,{className:"nextStep"},b["default"].createElement(r["default"],{type:"primary",htmlType:"submit",onClick:this.nextStep.bind(this,3)},"\u4e0b\u4e00\u6b65")))):null,3===t?b["default"].createElement("div",{className:"getBackStepThree"},b["default"].createElement("dl",null,b["default"].createElement("dt",null,b["default"].createElement(o["default"],{type:"check-circle",theme:"filled"})),b["default"].createElement("dd",null,"\u91cd\u7f6e\u6210\u529f")),b["default"].createElement("div",null,b["default"].createElement(r["default"],{onClick:this.turnToLogin},"\u8fd4 \u56de \u767b \u5f55"))):null)))}}]),t}(b.Component),E=y))||E)||E),x={background:"rgba(255, 206, 66, 1)",color:"#fff",border:"0"},T=60,q=v["default"].create({})(B),P=q;t["default"]=P},cfWd:function(e,t,a){}}]);